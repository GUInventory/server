# Migration `20201114180927-add-log`

This migration has been generated by Balint.Kiraly1 <balint.kiraly@protonmail.com> at 11/14/2020, 7:09:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."LogType" AS ENUM ('EDIT', 'UPDATE', 'DELETE')

CREATE TABLE "Log" (
"id" SERIAL,
    "entityName" TEXT NOT NULL,
    "entityId" INTEGER NOT NULL,
    "userId" INTEGER NOT NULL,
    "type" "LogType" NOT NULL,
    "oldValues" JSONB NOT NULL,
    "newValues" JSONB NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    PRIMARY KEY ("id")
)
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201112183532-token-is-unique..20201114180927-add-log
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -15,8 +15,14 @@
   EDITOR
   USER
 }
+enum LogType {
+  EDIT
+  UPDATE
+  DELETE
+}
+
 enum AttributeTypeEnum {
   STRING
   DATE
   DATETIME
@@ -147,4 +153,15 @@
   updatedAt DateTime          @updatedAt
   item      Item              @relation(fields: [itemId], references: [id])
   itemId    Int
 }
+
+model Log {
+  id         Int      @id @default(autoincrement())
+  entityName String
+  entityId   Int
+  userId     Int
+  type       LogType
+  oldValues  Json
+  newValues  Json
+  createdAt  DateTime @default(now())
+}
```


